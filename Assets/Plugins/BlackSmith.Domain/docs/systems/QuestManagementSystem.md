# クエスト管理システム (Quest Management System)

## 概要

クエスト管理システムは、Quest ドメインを中心として Character ドメインと連携し、クエスト情報管理に関するドメインサービスを提供します。\
クエスト基本情報管理、依頼者参照管理の各ドメインサービスにより、\
ライブラリ利用者はクエスト情報ロジックを構築できます。

## ドメイン問題の定義

### クエストドメインが扱う問題領域
- **クエスト基本情報管理**: クエストの識別・名称・説明の管理
- **依頼者参照管理**: クエストと依頼者との参照関係の管理
- **クエスト一意性保証**: QuestIDによるクエストの一意識別

### ドメイン間の関係性
- **Quest**: クエスト基本情報とデータ構造の定義
- **Character**: 依頼者（CharacterID）との参照関係

## 提供するドメインサービス

### クエスト基本情報管理サービス
クエストの基本情報（識別・名称・説明）の管理を提供します。

**提供する情報管理:**
- クエスト一意識別子（QuestID）の管理
- クエスト名称（QuestName）の管理
- クエスト説明（QuestDescription）の管理
- クエスト基本情報のイミュータブル管理

**情報管理ルール:**
- QuestIDによる一意識別を保証
- 基本情報は作成後の変更不可
- 依頼者との参照関係を必須とする

### 依頼者参照管理サービス
クエストと依頼者（Character）との参照関係管理を提供します。

**提供する参照管理:**
- CharacterIDによる依頼者との参照関係
- 依頼者の存在性前提での参照管理
- 参照関係の整合性保証

**参照管理ルール:**
- 全てのクエストは依頼者（CharacterID）を持つ
- 依頼者の削除時のクエスト状態管理（現在は基盤のみ）
- 参照関係の不変性保証

## ビジネスルール・制約

### クエスト識別制約
- **一意性制約**: QuestIDによる一意識別を保証
- **不変性制約**: 作成後のクエスト基本情報は変更不可
- **必須情報制約**: ID・名称・説明・依頼者IDは必須

### 依頼者参照制約
- **参照必須制約**: 全てのクエストは依頼者（CharacterID）を持つ
- **参照整合性**: 依頼者IDはCharacterドメインと整合性を保つ
- **参照不変性**: クエスト作成後の依頼者変更は不可

### ドメイン整合性
- **Character連携**: 依頼者IDとCharacterドメインの整合性
- **基本情報一貫性**: QuestModel内での情報一貫性保証

## 実装状況

### Domain層実装
- ✅ **QuestIDレコード**: クエスト一意識別子
- ✅ **QuestNameクラス**: クエスト名称管理
- ✅ **QuestDescriptionクラス**: クエスト説明管理
- ✅ **QuestModelクラス**: クエスト基本情報のモデル

### Usecase層実装
- ❌ **クエスト管理Usecase**: 未実装（Domain層で完結）

### インターフェース定義
- ❌ **クエスト操作インターフェース**: 未実装（現在は基本情報管理のみ）

## ドメインサービス API

### クエスト基本情報管理サービス
```csharp
// クエスト基本情報モデル
internal class QuestModel
{
    public QuestID ID { get; }                      // クエスト識別子
    public QuestName Name { get; }                  // クエスト名称
    public QuestDescription Description { get; }    // クエスト説明
    private CharacterID ClientId { get; }           // 依頼者ID
    
    // 基本情報の取得機能（詳細な操作メソッドは未実装）
}

// クエスト識別子
public record QuestID : BasicID
{
    // 一意識別子の基本機能を継承
}

// クエスト名称管理
public class QuestName
{
    // クエスト名称の管理（詳細実装は Quest.md を参照）
}

// クエスト説明管理
public class QuestDescription
{
    // クエスト説明の管理（詳細実装は Quest.md を参照）
}
```

### 依頼者参照管理
```csharp
// 依頼者参照の基盤
// QuestModel内でCharacterIDによる参照関係を管理
// 具体的な参照操作は未実装（基盤準備のみ）
```

### 基本的な利用パターン
1. **クエスト情報定義**: QuestModelで基本情報を定義
2. **依頼者関連付け**: CharacterIDで依頼者との関係を設定
3. **情報参照**: 基本情報への読み取り専用アクセス

### ドメインサービスの特徴
- **基本情報管理**: クエストの最小限情報管理
- **参照関係**: Character ドメインとの連携基盤
- **拡張可能設計**: 将来的な機能拡張に対応した基盤設計

### 実装の制限事項
現在の実装は基本情報管理に限定されており、以下の機能は未実装です：
- クエスト状態管理（受注・進行・完了等）
- クエスト進捗追跡システム
- クエスト報酬管理
- クエスト条件チェック機能

## 関連ドキュメント

- [Quest.md](../domains/Quest.md) - クエスト基本実装詳細
- [Character.md](../domains/Character.md) - 依頼者システム詳細
- [DomainInteractions.md](../integration/DomainInteractions.md) - ドメイン間連携